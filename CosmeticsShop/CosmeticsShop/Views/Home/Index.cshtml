
@{
    ViewBag.Title = "Trang chủ";
    Layout = "~/Views/Shared/_HomeLayout.cshtml";

    List<CosmeticsShop.Models.Product> products = ViewBag.ListProduct as List<CosmeticsShop.Models.Product>;
}
<script>
    $(document).ready(function () {
        $(".item_add").on('click', function () {
            event.preventDefault();
            var ID = $(this).data("id");
            $.ajax({
                url: '/Cart/AddItem',
                data: {
                    ProductID: ID
                },
                type: 'POST',
                dataType: 'json',
                success: function (response) {
                    if (response.status == true) {
                        $.notify("Thêm vào giỏ hàng thành công!", "success");

                        $.ajax({
                            url: '/Cart/GetTotalCart',
                            type: 'GET',
                            dataType: 'json',
                            success: function (response) {
                                $(".simpleCart_total").html(response.TotalPrice + "₫ (" + response.TotalQuantity + ")")
                            },
                        });
                    } else {
                        $.notify("Số lượng không đủ!", "error");
                    }
                },
            });
        })
    });
</script>
<!--banner-->
<div class="banner">
    <div class="matter-banner">
        <div class="slider">
            <div class="callbacks_container">
                <ul class="rslides" id="slider">
                    <li>
                        <img src="~/Content/images/banner.jpg" alt="">
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="clearfix"> </div>
</div>
<!--//banner-->
<div class="products">
    <div class="container">
        <h2>Sản phẩm bán chạy</h2>
        <div class="col-md-9">
            @if (products.Count > 0)
            {
                for (int i = 0; i < products.Count; i += 3)
                {
                    <div class="content-top1">
                        @for (int j = i; j < i + 3; j++)
                        {
                            <div class="col-md-4 col-md4">
                                <div class="col-md1 simpleCart_shelfItem">
                                    @if (j < products.Count)
                                    {
                                        <a href="/Product/Details/@products[j].ID">
                                            <img class="img-responsive" src="~/Content/images/@products[j].Image1" alt="" style="height:250px;width:200px" />
                                        </a>
                                        <h3><a href="/Product/Details/@products[j].ID">@products[j].Name</a></h3>
                                        <div class="price">
                                            <h5 class="item_price">@products[j].Price.Value.ToString("#,##")₫</h5>
                                            <p class="item_price">Đã bán: @products[j].PurchasedCount (Còn lại @products[j].Quantity)</p>
                                            <a href="#" class="item_add" data-id="@products[j].ID">Chọn mua</a>
                                            <div class="clearfix"></div>
                                        </div>
                                    }
                                    
                                </div>
                            </div>
                        }
                        <div class="clearfix"></div>
                    </div>
                }
            }
            else
            {
                <h3>Không có sản phẩm nào...</h3>
            }
        </div>
    </div>
</div>
